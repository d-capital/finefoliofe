<ng-container *ngIf="!loading; else loadingSkeleton">
  <ng-container *ngIf="!error; else errorTemplate">
    <div class="valuate-container">
      <h1>{{ stockInfo.name }} ({{ stockInfo.ticker }})</h1>
      <p class="exchange">{{exchangeLabel}}{{ stockInfo.exchange }} | {{countryLabel}}{{ stockInfo.country }}</p>

      <!-- Public stock data -->
      <section class="card">
        <h2>{{stockInformationLabel}}</h2>
        <ul>
          <li><strong>{{priceLabel}}</strong> ${{ round(stockInfo.price) }}</li>
          <li><strong>{{marketCapLabel}}</strong> {{ stockInfo.capitalization | abbreviateNumber }}</li>
          <li><strong>{{sectorLabel}}</strong> {{ stockInfo.sector }}</li>
          <li><strong>{{industryLabel}}</strong> {{ stockInfo.industry }}</li>
          <li><strong>{{epsTtmLabel}}</strong> {{ round(stockInfo.epsTtm) }}</li>
          <li><strong>{{peTtmLabel}}</strong> {{ round(stockInfo.peTtm) }}</li>
          <li><strong>{{dividendsYieldLabel}}</strong> {{ round(stockInfo.dividendYield) }}%</li>
        </ul>
      </section>

      <!-- Valuation -->
      <section class="card">
        <h2>{{valuationResultsLabel}}</h2>
        <p>
          <strong>{{fairPriceLabel}}</strong> ${{ round(valuation.fairPrice) }}
        </p>
        <p>
          <strong>{{resultLabel}}</strong>
          <span *ngIf="valuation.resultLabel==='Undervalued'" class="undervalued">
            {{undervaluedLabel}}({{ round(valuation.resultPercent) }}%)
          </span>
          <span *ngIf="valuation.resultLabel==='Overvalued'" class="overvalued">
            {{overvaluedLabel}}({{ round(valuation.resultPercent) }}%)
          </span>
        </p>
        <p><strong>{{formulaLabel}}</strong> {{ valuation.formula }}</p>
        <p class="explanation">{{ formulaExplanationLabel }}</p>
      </section>

      <!-- Historical profit -->
      <section class="card">
        <h2>{{netProfitGrowthLabel}}</h2>
        <ul>
          <li *ngFor="let item of valuation.netProfitHistory">
            {{ item.year }}: {{ item.value  | abbreviateNumber }}
          </li>
        </ul>
        <p><strong>{{averageIncomeGrowthLabel}}</strong></p>
        <ul>
          <li>{{averageIncomeGrowthTtm}}{{ valuation.avgGrowth.ttm }}%</li>
          <li>{{averageThreeYearsGrowth}}{{ valuation.avgGrowth.threeYears }}%</li>
          <li>{{averageFiveYearsGrowth}}{{ valuation.avgGrowth.fiveYears }}%</li>
        </ul>
      </section>

      <!-- Lynch explanation -->
      <section class="card">
        <h2>{{aboutLynchFormulaLabel}}</h2>
        <p>
          {{aboutLynchFormulaText}}
        </p>
      </section>
    </div>
  </ng-container>
</ng-container>

<!-- Skeleton Template -->
<ng-template #loadingSkeleton>
  <div class="valuate-container">
    <h1 class="skeleton-box long"></h1>
    <p class="exchange skeleton-box medium"></p>

    <div class="card">
      <h2 class="skeleton-box medium"></h2>
      <div *ngFor="let i of [1,2,3,4,5,6]" class="skeleton-box short"></div>
    </div>

    <div class="card">
      <h2 class="skeleton-box medium"></h2>
      <div *ngFor="let i of [1,2,3]" class="skeleton-box medium"></div>
    </div>

    <div class="card">
      <h2 class="skeleton-box medium"></h2>
      <div *ngFor="let i of [1,2,3,4,5]" class="skeleton-box long"></div>
    </div>
  </div>
</ng-template>

<!-- Error Template -->
<ng-template #errorTemplate>
  <app-error-state [showHomeButton]="true"></app-error-state>
</ng-template>
